%
%
\begin{tikzpicture}[font=\small]
    \tikzstyle{image} = [anchor=center,
                         inner sep=0, outer sep=0,
                         node distance = 0.3cm and 0,
                         % draw=black,
                         minimum width=0.5\figurewidth]
    \tikzstyle{label} = [anchor=north,
                         align=left]
    \input{colormap_cooltowarm_extended}
    \input{colormap_green_purple}

    \node[image] (image1)
    {
        \begin{tikzpicture}
            \node[image] (base) at (0,0) {\includegraphics[height=0.45\figurewidth]{figures/spherical_time_1_02e-4}};%
            \begin{scope}
                \clip (base.south west) -- (base.north west) -- (base.north east) -- (base.south east) -- cycle;
                \clip (-2.0, -3.5) -- (2.0, 3.5) -- (4.0, 3.5) -- (4.0, -3.5)  -- cycle;
                \node[image] at (0,0) {\includegraphics[height=0.45\figurewidth]{figures/spherical_time_1_02e-4_density_factor}};%
            \end{scope}
            \draw[thick, dashed, shorten <=2.1cm, shorten >=2.45cm] (-2.0, -3.5) -- (2.0, 3.5);
        \end{tikzpicture}
    };
    \node[label, yshift=1.3cm] at (image1.south) {$\begin{aligned}t &= \SI{1e-4}{\second} \\ N&=\num{50}\si{\kilo}\end{aligned}$};

    \node[image, right=of image1] (image2)
    {
        \begin{tikzpicture}
            \node[image] (base) {\includegraphics[height=0.45\figurewidth]{figures/spherical_time_1_7e-4}};%
            \begin{scope}
                \clip (base.south west) -- (base.north west) -- (base.north east) -- (base.south east) -- cycle;
                \clip (-2.0, -3.5) -- (2.0, 3.5) -- (4.0, 3.5) -- (4.0, -3.5)  -- cycle;
                \node[image] {\includegraphics[height=0.45\figurewidth]{figures/spherical_time_1_7e-4_density_factor}};%
            \end{scope}
            \draw[thick, dashed, shorten <=1.7cm, shorten >=2.2cm] (-2.0, -3.5) -- (2.0, 3.5);
        \end{tikzpicture}
    };
    \node[label, yshift=1.3cm] at (image2.south) {$\begin{aligned}t &= \SI{1.7e-4}{\second} \\ N&=\num{140}\si{\kilo}\end{aligned}$};

    \node[image, below=of image1] (image3)
    {
        \begin{tikzpicture}
            \node[image] (base) {\includegraphics[height=0.45\figurewidth]{figures/spherical_time_2_4e-4}};%
            \begin{scope}
                \clip (base.south west) -- (base.north west) -- (base.north east) -- (base.south east) -- cycle;
                \clip (-2.0, -3.5) -- (2.0, 3.5) -- (4.0, 3.5) -- (4.0, -3.5)  -- cycle;
                \node[image] {\includegraphics[height=0.45\figurewidth]{figures/spherical_time_2_4e-4_density_factor}};%
            \end{scope}
            \draw[thick, dashed, shorten <=1.4cm, shorten >=1.9cm] (-2.0, -3.5) -- (2.0, 3.5);
        \end{tikzpicture}
    };
    \node[label, yshift=0.5cm] at (image3.south) {$\begin{aligned}t &= \SI{2.4e-4}{\second} \\ N&=\num{400}\si{\kilo}\end{aligned}$};

    \node[image, right=of image3] (image4)
    {
        \begin{tikzpicture}
            \node[image] (base) {\includegraphics[height=0.45\figurewidth]{figures/spherical_time_3e-4}};%
            \begin{scope}
                \clip (base.south west) -- (base.north west) -- (base.north east) -- (base.south east) -- cycle;
                \clip (-2.0, -3.5) -- (2.0, 3.5) -- (4.0, 3.5) -- (4.0, -3.5)  -- cycle;
                \node[image] {\includegraphics[height=0.45\figurewidth]{figures/spherical_time_3e-4_density_factor}};%
            \end{scope}
            \draw[thick, dashed, shorten <=1.05cm, shorten >=1.6cm] (-2.0, -3.5) -- (2.0, 3.5);
        \end{tikzpicture}
    };
    \node[label, yshift=0.5cm] at (image4.south) {$\begin{aligned}t &= \SI{3.1e-4}{\second} \\ N&=\num{870}\si{\kilo}\end{aligned}$};

    % \node (bbnw) at ($(image1.north west) + (-1.25, 0.4)$) {};
    % \node (bbse) at ($(image4.south east) + (1.35, -0.45)$) {};
    \coordinate (bottom) at ([yshift=-3cm]image4.south);

    \clip (image1.north west) rectangle (bottom -| image4.east);

    \node[anchor=north, yshift=-1.5cm, xshift=-3.5mm] at (image3.south){
        \begin{axis}[
        scale only axis,
        height=4cm,
        hide axis,
        domain=1.5:1.5,
        colorbar horizontal,
        colorbar/width=0.25cm,
        colormap name={cooltowarm_extended},
        point meta min=-1.5, point meta max=1.5,
        colorbar style={
            xlabel=\strut$c$,
            scaled ticks=false,
            xtick={-1, 0, 1},
            xticklabels={$10^{-1}$, $10^{\,0}$, $10^{\,1}$},
            % extra y ticks ={0.3, 0.4771212, 0.60206, 0.69897, 0.778151, 0.845098, 0.90309, 0.954242, 1.3, 1.4771212,
            %                 -0.3, -0.4771212, -0.60206, -0.69897, -0.778151, -0.845098, -0.90309, -0.954242, -1.3, -1.4771212},
            % extra y tick labels=\empty
        }]
      \end{axis}
    };
    \node[anchor=north, yshift=-1.5cm, xshift=-3.5mm] at (image4.south){
        \begin{axis}[
        scale only axis,
        height=4cm,
        hide axis,
        domain=-2.5:2.5,
        colorbar horizontal,
        colorbar/width=0.25cm,
        colormap name={green_purple},
        point meta min=-2.5, point meta max=2.5,
        colorbar style={
            xlabel=\strut$d$,
            scaled ticks=false,
            xtick={-2, -1, 0, 1, 2},
            xticklabels={$10^{-2}$, $10^{-1}$, $10^{\,0}$, $10^{\,1}$, $10^{\,2}$},
            % extra y ticks ={1, 1.3, 1.4771212, 1.60206, 1.69897, 1.778151, 1.845098, 1.90309, 1.954242,
            %                 -1, -1.3, -1.4771212, -1.60206, -1.69897, -1.778151, -1.845098, -1.90309, -1.954242},
            % extra y tick labels=\empty
        }]
      \end{axis}
    };
\end{tikzpicture}%
