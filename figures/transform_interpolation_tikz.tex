%
%
\begin{tikzpicture}[
	font=\small,
	thick,
	scale=\figurewidth/1cm*0.13,
	line join=round]
\tikzstyle{ghostparticle} = [fill=white, arrows=-o]
\tikzstyle{b1style} = [mycolor4, arrows=-latex]
\tikzstyle{b2style} = [mycolor1, arrows=-latex]
\tikzstyle{b1dstyle} = [very thick, mycolor4!50, arrows=-latex]
\tikzstyle{b2dstyle} = [very thick, mycolor1!50, arrows=-latex]
\tikzstyle{ellipse1style} = [mycolor3!70]
\tikzstyle{ellipse2style} = [mycolor2!70]

\coordinate (center1) at (0, 0);
\coordinate (x1) at (1.5, 0.15);
\coordinate (x2) at (-1, -0.1);
\coordinate (x3) at (0.15, 1.5);
\coordinate (x4) at (-0.1, -1);
\coordinate (b1) at (1.25, 0.125);
\coordinate (b2) at (0.125, 1.25);
\coordinate (vx) at ($ (center1)!2/3!(b1) + (center1)!2/3!(b2)$);

% normal
% \draw [fill=black, arrows=-latex]
% 	(center1) -- (0, 0, 1) node [below left] {$\vn$};

\fill [ellipse1style] (center1) circle [radius=0.4];
\fill [ellipse2style] (vx) circle [radius=0.4];

\node [below right] at (center1) {$\vx$};

\draw [ghostparticle] (center1) -- (x1) node [above] {$\vx_1$};
\draw [ghostparticle] (center1) -- (x2) node [left] {$\vx_2$};
\draw [ghostparticle] (center1) -- (x3) node [above] {$\vx_3$};
\draw [ghostparticle] (center1) -- (x4) node [below] {$\vx_4$};

\draw [b1style] (center1) -- (b1) node [below left] {$\vb_1$};
\draw [b2style] (center1) -- (b2) node [below left] {$\vb_2$};


\draw [b1dstyle] (center1) -- ($ (center1)!2/3!(b1) $)
		node [above, pos=0.6] {$a$};
\draw [b2dstyle, shorten >=0.1cm] ($ (center1)!2/3!(b1) $) --
		($ (center1)!2/3!(b1) + (center1)!2/3!(b2)$)
		node [left, pos=0.4] {$b$};

\draw [fill=black] (vx) circle [radius=0.08]
		node [right, xshift=0.05cm] {$\vx'$};

\begin{scope}[shift={(4.2, 0)}]
	\coordinate (center2) at (0, 0);
	\coordinate (x1) at (2, -1);
	\coordinate (x2) at (-1, 0.5);
	\coordinate (x3) at (2, 1);
	\coordinate (x4) at (-1, -0.5);
	\coordinate (b1) at (1.5, -0.75);
	\coordinate (b2) at (1.5, 0.75);
	\coordinate (vx2) at ($ (center2)!2/3!(b1) + (center2)!2/3!(b2)$);

	% normal
	% \draw [fill=black, arrows=-latex]
	% 	(center2) -- (0, 0, 1) node [below] {$\vn$};
	\fill [ellipse1style] (center2) circle [x radius=0.5, y radius=0.4];
	\fill [ellipse2style] (vx2) circle [x radius=0.6, y radius=0.4];

	\node [below] at (center2) {$\vx$};

	\draw [ghostparticle] (center2) -- (x1) node [right] {$\vx_1$};
	\draw [ghostparticle] (center2) -- (x2) node [left] {$\vx_2$};
	\draw [ghostparticle] (center2) -- (x3) node [right] {$\vx_3$};
	\draw [ghostparticle] (center2) -- (x4) node [left] {$\vx_4$};

	\draw [b1style] (center2) -- (b1) node [below left] {$\vb_1$};
	\draw [b2style] (center2) -- (b2) node [above left] {$\vb_2$};

	\draw [b1dstyle] (center2) -- ($ (center2)!2/3!(b1) $)
			node [above right, pos=0.6] {$a$};
	\draw [b2dstyle, shorten >=0.1cm] ($ (center2)!2/3!(b1) $) -- (vx2)
			node [above left, pos=0.4] {$b$};

	\draw [fill=black] (vx2) circle [radius=0.08]
		node [right, xshift=0.05cm] {$\vx'$};
\end{scope}

\draw [very thick, ellipse1style, shorten <=0.6cm, shorten >=0.6cm, arrows=-latex]
		(center1) to[out=-40, in=220]
			node [below, midway, text=black, yshift=-0.1cm] {$\mE$}
		(center2);

\draw [very thick, ellipse2style, shorten <=0.6cm, shorten >=0.7cm, arrows=-latex]
		(vx) to[out=25, in=145]
			node [above, midway, text=black, yshift=0.1cm] {$\mE'$}
		(vx2);

\node[yshift=-2.3cm, xshift=0.5cm] at (center1) {$t_{k-1}$};
\node[yshift=-2.3cm, xshift=1cm] at (center2) {$t_{k}$};

\end{tikzpicture}